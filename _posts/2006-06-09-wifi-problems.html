---
layout: post
title: Wifi problems
categories:
- computers
comments: []
---
<p>Ok, again, but this time it isn't going to be a rant, but rather description of my situation with request for help. :-)</p>
<p>We have a small wifi network (I am one of the two clients). We live very close, it's only like 30-50m between me and the AP. The antennas can "see" each other. I use Intersil Prism 2.5 wavelan chipset. The AP is Draytek Vigor2006Ge.</p>
<p>It used to work, but lately my connection is really weird. It jumps between three states: no connection at all (there could be several reasons for it and it usually doesn't last long anyway, so don't bother), 100kbit and 3mbit (that's what I want :-)). Weird thing is that "link quality" stays the same whether it's 100kbit or 3mbit (it's around 30-36 all the time). I test my connection with:</p>
<blockquote><p>ping -s 1024 -c 1024 -f 10.0.0.138</p>
<p>1024 packets transmitted, 217 received, +35 duplicates, 78% packet loss, time 16021ms<br />
rtt min/avg/max/mdev = 12.104/4771.567/6546.469/1548.455 ms, pipe 417, ipg/ewma 15.661/5394.273 ms</p></blockquote>
<p>where -s is size of the packet, -c is number of packets and -f sends one after another very fast (and 10.0.0.138 is the IP of the AP ). When the connection is good I have 0% packet loss (usually one or two drop) and time 5000ms, it's a <strong>big</strong> difference.<br />
Another weird thing is that when I had no signal, no connection (yes, I was trying to connect to the correct AP all the time), I could see a lot of packets flying around. There were like 30-60 of them every second, all flying to 10.0.0.1, which is the other guy connected to the AP. Let me give you an example:</p>
<blockquote><p>IP 147.230.151.63.11539 > 10.0.0.1.27390: . 187868:189270(1402) ack 1 win 65535</p></blockquote>
<p>It's probably DirectConnect, but that doesn't really matter, the question is how comes I could see all those packets?</p>
<p>Here is some further information, but I doubt it will help anyone:</p>
<blockquote><p>ifconfig<br />
eth1      Link encap:Ethernet  HWaddr 00:60:B3:6D:79:6F<br />
inet addr:10.0.0.32  Bcast:10.0.0.255  Mask:255.255.255.0<br />
inet6 addr: fe80::260:b3ff:fe6d:796f/64 Scope:Link<br />
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br />
RX packets:782667 errors:343223 dropped:343223 overruns:0 frame:343216<br />
TX packets:199530 errors:903 dropped:0 overruns:0 carrier:0<br />
collisions:0 txqueuelen:1000<br />
RX bytes:687827081 (655.9 MiB)  TX bytes:34106034 (32.5 MiB)<br />
Interrupt:11 Memory:df011000-df011fff</p>
<p>iwconfig<br />
eth1      IEEE 802.11b  ESSID:"mynet"  Nickname:"zluty kopec"<br />
Mode:Managed  Frequency:2.467 GHz  Access Point: 00:11:09:0E:51:33<br />
Bit Rate:1 Mb/s   Sensitivity:1/3<br />
Retry min limit:8   RTS thr:off   Fragment thr:off<br />
Power Management:off<br />
Link Quality=32/92  Signal level=-101 dBm  Noise level=-149 dBm<br />
Rx invalid nwid:0  Rx invalid crypt:14  Rx invalid frag:0<br />
Tx excessive retries:1113  Invalid misc:0   Missed beacon:0</p>
<p>route<br />
Kernel IP routing table<br />
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br />
10.0.0.0        *               255.255.255.0   U     0      0        0 eth1<br />
default         10.0.0.138      0.0.0.0         UG    0      0        0 eth1</p></blockquote>
<p>What totally puzzles me are the jumps. I've finally seen it yesterday, it jumped from link quality 0/92 to 34/92 in one second (I've got a script that does something like this: iwconfig | grep the relevant line, sleep a second).  I probably needn't mention that the jumps are not connected with any changes we make, it's completely independent and seemingly random.</p>
<p>And how comes I have a <span style="font-style: italic">very </span>different connection speed (30 times lower) with the same signal quality?</p>
